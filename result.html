<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <title>CET Live Rank</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      margin: 0;
      padding: 16px;
    }
    .card {
      max-width: 600px;
      margin: 0 auto;
      background: #020617;
      border-radius: 24px;
      padding: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.5);
      border: 1px solid #1f2937;
    }
    .title {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 4px;
    }
    .subtitle {
      font-size: 13px;
      color: #9ca3af;
      margin-bottom: 16px;
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .pill {
      background: #020617;
      border-radius: 16px;
      padding: 8px 10px;
      border: 1px solid #1f2937;
    }
    .pill-label {
      font-size: 11px;
      color: #9ca3af;
    }
    .pill-value {
      font-size: 16px;
      font-weight: 600;
    }
    .highlight {
      font-size: 32px;
      font-weight: 800;
      text-align: center;
      margin: 12px 0;
    }
    .badge {
      display: inline-block;
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      background: #1e293b;
      color: #e5e7eb;
      border: 1px solid #4b5563;
      margin-bottom: 8px;
    }
    .footer {
      font-size: 11px;
      color: #6b7280;
      margin-top: 12px;
      text-align: right;
    }
    .error {
      color: #fecaca;
      text-align: center;
      margin-top: 16px;
      font-size: 12px;
    }
    .share-btn {
      width: 100%;
      margin-top: 14px;
      padding: 9px 12px;
      border-radius: 999px;
      border: none;
      font-size: 14px;
      font-weight: 500;
      background: #1f2937;
      color: #e5e7eb;
      cursor: pointer;
    }
    .insta-note {
      font-size: 18px;
      color: #9ca3af;
      margin-top: 10px;
      line-height: 1.5;
      text-align: center;
    }
    .insta-link {
      color: #38bdf8;
      text-decoration: none;
      font-weight: 500;
    }
    .section {
      max-width: 600px;
      margin: 16px auto 0;
      font-size: 11px;
      color: #9ca3af;
      line-height: 1.5;
    }
    .section h2 {
      font-size: 12px;
      margin: 0 0 6px;
      color: #e5e7eb;
    }
    .section ul {
      padding-left: 18px;
      margin: 4px 0 0;
    }
  </style>
</head>
<body>
  <div class="card">
    <div class="title">CET Live Rank</div>
    <div class="subtitle">
      HSSC CET Marks Card ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§Ü‡§™‡§ï‡§æ Rank  
      <br>‡§Ø‡§π ‡§™‡•á‡§ú ‡§Ö‡§™‡§®‡•á ‡§Ü‡§™ ‡§π‡§∞ ‡§ï‡•Å‡§õ ‡§∏‡•á‡§ï‡§Ç‡§° ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§°‡•á‡§ü ‡§π‡•ã‡§§‡§æ ‡§∞‡§π‡•á‡§ó‡§æ (Live Rank)‡•§
    </div>

    <div id="userInfo" class="grid" style="margin-bottom: 12px;"></div>

    <div class="badge" id="marksBadge">Marks: --</div>

    <div class="highlight" id="overallRank">#--</div>
    <div style="text-align:center;font-size:12px;color:#9ca3af;margin-bottom:12px;">
      Overall Rank (‡§∏‡§≠‡•Ä Candidates ‡§Æ‡•á‡§Ç)
    </div>

    <div class="grid">
      <div class="pill">
        <div class="pill-label">Category-wise Rank</div>
        <div class="pill-value" id="catRank">--</div>
      </div>
      <div class="pill">
        <div class="pill-label">Gender-wise Rank</div>
        <div class="pill-value" id="genderRank">--</div>
      </div>
      <div class="pill">
        <div class="pill-label">Age-wise Rank</div>
        <div class="pill-value" id="ageRank">--</div>
      </div>
      <div class="pill">
        <div class="pill-label">Exam Date-wise Rank</div>
        <div class="pill-value" id="examDateRank">--</div>
      </div>
    </div>

    <button class="share-btn" type="button" onclick="handleShare()">
      üîó ‡§á‡§∏ ‡§∞‡•à‡§Ç‡§ï ‡§™‡•á‡§ú ‡§ï‡•ã ‡§¶‡•ã‡§∏‡•ç‡§§‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç
    </button>

    <div class="insta-note">
      
‡§ò‡§¨‡§∞‡§æ‡§Ø‡•á ‡§®‡§π‡•Ä‡§Ç ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü under maintanance ‡§π‡•à ‡§ú‡§≤‡•ç‡§¶‡•Ä ‡§π‡•Ä ‡§†‡•Ä‡§ï ‡§ï‡§∞ ‡§¶‡•Ä ‡§ú‡§æ‡§è‡§ó‡•Ä ‡§Ü‡§ú ‡§∏‡§æ‡§Æ 5 ‡§¨‡§ú‡•á ‡§§‡§ï  
      site under maintenance hai jaldi hi thek kar di jayegi  5pm tk
      <br>
      Instagram:
      <a class="insta-link" href="https://instagram.com/adv_kanha73" target="_blank">@adv_kanha73</a>
    </div>

    <div class="footer" id="lastUpdated">
      Rank as on: --
    </div>

    <div class="error" id="errorBox"></div>
  </div>

  <div class="section">
    <h2>‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡•Ç‡§ö‡§®‡§æ (Disclaimer)</h2>
    ‡§Ø‡§π <b>‡§ï‡•ã‡§à ‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§®‡§π‡•Ä‡§Ç</b> ‡§π‡•à ‡§î‡§∞ ‡§® ‡§π‡•Ä ‡§Ø‡§π HSSC ‡§Ø‡§æ ‡§ï‡§ø‡§∏‡•Ä ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡•Ä ‡§π‡•Å‡§à ‡§π‡•à‡•§  
    ‡§Ø‡§π ‡§ï‡•á‡§µ‡§≤ ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ <b>Unofficial Rank Calculator</b> ‡§π‡•à‡•§

    <h2 style="margin-top:12px;">Terms &amp; Conditions (‡§∂‡§∞‡•ç‡§§‡•á‡§Ç)</h2>
    <ul>
      <li>‡§Ü‡§™ ‡§ú‡•ã ‡§≠‡•Ä PDF ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§µ‡§π ‡§ï‡•á‡§µ‡§≤ ‡§∞‡•à‡§Ç‡§ï ‡§®‡§ø‡§ï‡§æ‡§≤‡§®‡•á ‡§ï‡•á ‡§â‡§¶‡•ç‡§¶‡•á‡§∂‡•ç‡§Ø ‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§</li>
      <li>‡§Ü‡§™‡§ï‡§æ ‡§°‡•á‡§ü‡§æ ‡§ï‡§ø‡§∏‡•Ä ‡§§‡•Ä‡§∏‡§∞‡•á ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§ï‡•ã ‡§∂‡•á‡§Ø‡§∞, ‡§¨‡•á‡§ö‡§æ ‡§Ø‡§æ ‡§ó‡§≤‡§§ ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ‡•§</li>
      <li>‡§∞‡•à‡§Ç‡§ï ‡§ï‡§æ calculation official ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à, ‡§Ø‡§π user-submitted ‡§°‡•á‡§ü‡§æ ‡§™‡§∞ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§π‡•à‡•§</li>
      <li>‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§§‡§∞‡§π ‡§ï‡•Ä Official Merit List ‡§Ø‡§æ Final Decision ‡§π‡§Æ‡•á‡§∂‡§æ HSSC ‡§ï‡•á official result ‡§™‡§∞ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§π‡•ã‡§ó‡§æ‡•§</li>
      <li>‡§á‡§∏ ‡§ü‡•Ç‡§≤ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§ó‡§≤‡§§‡§´‡§π‡§Æ‡•Ä ‡§Ø‡§æ ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§ï‡•á ‡§≤‡§ø‡§è developer ‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§ó‡§æ‡•§</li>
    </ul>
  </div>

  <script>
  const BACKEND_URL = "https://script.google.com/macros/s/AKfycbwHo7ecIYJP-ekEOfsCnD1BUtbSJ_nF6ZNZ2vi_hsQb6fyA0GBurHQTxWbPrm0DKZzOIQ/exec";

  function getQueryParam(name) {
    const url = new URL(window.location.href);
    return url.searchParams.get(name);
  }

  function formatDateTime(iso) {
    if (!iso) return "--";
    const d = new Date(iso);
    return d.toLocaleString("en-IN", { timeZone: "Asia/Kolkata" });
  }

  async function fetchLiveRank() {
    const roll = getQueryParam("roll");
    const errorBox = document.getElementById("errorBox");

    if (!roll) {
      errorBox.textContent = "Roll number ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ (URL ‡§Æ‡•á‡§Ç ?roll= ‡§°‡§æ‡§≤‡•á‡§Ç)‡•§";
      return;
    }

    try {
      errorBox.textContent = "Rank ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...";
      const res = await fetch(`${BACKEND_URL}?roll=${encodeURIComponent(roll)}`);
      const data = await res.json();

      if (!data || data.error) {
        errorBox.textContent = data && data.error
          ? data.error
          : "‡§ï‡•Å‡§õ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§π‡•ã ‡§ó‡§à (empty response)‡•§";
        return;
      }

      if (!data.user) {
        errorBox.textContent = "‡§á‡§∏ Roll number ‡§ï‡§æ ‡§°‡•á‡§ü‡§æ Sheet ‡§Æ‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§";
        return;
      }

      errorBox.textContent = "";

const u = data.user;

        document.getElementById("userInfo").innerHTML = `
          <div class="pill"><div class="pill-label">Name</div><div class="pill-value">${u.name}</div></div>
          <div class="pill"><div class="pill-label">Roll</div><div class="pill-value">${u.roll}</div></div>
          <div class="pill"><div class="pill-label">Gender</div><div class="pill-value">${u.gender}</div></div>
          <div class="pill"><div class="pill-label">Category</div><div class="pill-value">${u.category}</div></div>
          <div class="pill"><div class="pill-label">DOB</div><div class="pill-value">${u.dob}</div></div>
          <div class="pill"><div class="pill-label">Exam Date</div><div class="pill-value">${u.exam_date}</div></div>
        `;      document.getElementById("marksBadge").textContent =
        `Marks: ${u.cet_marks != null ? u.cet_marks : "--"}`;

      document.getElementById("overallRank").textContent = "#" + (r.overallRank || "--");
      document.getElementById("catRank").textContent = "#" + (r.categoryRank || "--");
      document.getElementById("genderRank").textContent = "#" + (r.genderRank || "--");
      document.getElementById("ageRank").textContent = r.ageRank ? ("#" + r.ageRank) : "--";
      document.getElementById("examDateRank").textContent = "#" + (r.examDateRank || "--");

      document.getElementById("lastUpdated").textContent =
        "Rank as on: " + formatDateTime(data.rankTime) +
        ` | Total Candidates: ${stats.totalCandidates || "--"}`;
    } catch (err) {
      console.log(err);
      errorBox.textContent = "Network error / Backend issue.";
    }
  }

  async function handleShare() {
    const url = window.location.href;
    const text = "‡§Æ‡•à‡§Ç‡§®‡•á ‡§Ö‡§™‡§®‡§æ HSSC CET Live Rank ‡§Ø‡§π‡§æ‡§Å ‡§ö‡•á‡§ï ‡§ï‡§ø‡§Ø‡§æ, ‡§Ü‡§™ ‡§≠‡•Ä ‡§Ö‡§™‡§®‡§æ ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:";

    try {
      if (navigator.share) {
        await navigator.share({ title: "CET Live Rank", text, url });
      } else {
        await navigator.clipboard.writeText(url);
        alert("‡§≤‡§ø‡§Ç‡§ï ‡§ï‡•â‡§™‡•Ä ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ!");
      }
    } catch {}
  }

  fetchLiveRank();
  setInterval(fetchLiveRank, 10000);
</script>

</body>
</html>
